#!/usr/bin/python
from loopb.bview import BView, get_argument_parser
from loopb.bview.plugins.record import VideoRecorder, CamRecorder

if __name__ == "__main__":
    parser = get_argument_parser()
    parser.add_argument('--dest', required=True,
                        help='destination filename (without extension)')
    parser.add_argument('--codec', default='libx264', choices=CamRecorder.list_available_codecs(),
                        help='storage format of image store')
    parser.add_argument('--start', action='store_true', default=False,
                        help='start recording immediately')
    parser.add_argument('--statusbar', action='store_true', default=False,
                        help='show statusbar')

    args = parser.parse_args()

    bview = BView.new_from_commandline_args(args)
    bview.attach_plugin(VideoRecorder(dest=args.dest, codec=args.codec, show_statusbar=args.statusbar,
                                      start_recording=args.start))
    bview.main()
